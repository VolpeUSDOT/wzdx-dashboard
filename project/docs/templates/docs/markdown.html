{% extends 'base.html' %}

{% load static %}

{% load markdown_cleaner %}

{% block head%}
<link rel="stylesheet" type="text/css" href="{% static 'docs/styles.css' %}">
{% endblock %}

{% block title %}{{ markdown_content.title }}{% endblock %}

{% block content %}
<div class="usa-section">
    <div class="grid-container">
      <div class="grid-row grid-gap">
        <div
          class="usa-layout-docs__sidenav display-none desktop:display-block desktop:grid-col-3"
        >
          <nav aria-label="Secondary navigation">
            <ul class="usa-sidenav">
            {% for docs_link in all_docs %}
                <li class="usa-sidenav__item">
                    <a href="/docs/{{ docs_link.slug }}" class="{% if docs_link.current_page %}usa-current{% endif %}">{{ docs_link.title }}</a>
                    {% if docs_link.current_page %}
                        {% with markdown_content.content|get_toc as toc_dict %}
                            {% if toc_dict %}
                                <ul class="usa-sidenav__sublist">
                                {% for toc_first_level in toc_dict %}
                                    <li class="usa-sidenav__item">
                                        <a href="#{{ toc_first_level.id }}"
                                        >{{ toc_first_level.name }}</a
                                        >
                                        {% if toc_first_level.children %}
                                            <ul class="usa-sidenav__sublist">
                                                {% for toc_second_level in toc_first_level.children %}
                                                    <li class="usa-sidenav__item">
                                                        <a href="#{{ toc_second_level.id }}"
                                                        >{{ toc_second_level.name }}</a
                                                        >
                                                    </li>
                                                {% endfor %}
                                            </ul>
                                        {% endif %}
                                    </li>
                                {% endfor %}
                                </ul>
                            {% endif %}
                        {% endwith %}
                    {% endif %}
                </li>
            {% endfor%}
            </ul> 
        </nav>
    </div>
    <main class="desktop:grid-col-9 usa-prose" id="main-content">
        <h1>{{ markdown_content.title }}</h1>
        {% if markdown_content.intro%}
            <p class="usa-intro">
                {{ markdown_content.intro }}
            </p>
        {% endif %}
        {{ markdown_content.content|render_markdown }}
    </main>
      <div class="usa-layout-docs__sidenav desktop:display-none">
        <nav aria-label="Secondary navigation">
          <ul class="usa-sidenav">
          {% for docs_link in all_docs %}
              <li class="usa-sidenav__item">
                  <a href="/docs/{{ docs_link.slug }}" class="{% if docs_link.current_page %}usa-current{% endif %}">{{ docs_link.title }}</a>
                  {% if docs_link.current_page %}
                      {% with markdown_content.content|get_toc as toc_dict %}
                          {% if toc_dict %}
                              <ul class="usa-sidenav__sublist">
                              {% for toc_first_level in toc_dict %}
                                  <li class="usa-sidenav__item">
                                      <a href="#{{ toc_first_level.id }}"
                                      >{{ toc_first_level.name }}</a
                                      >
                                      {% if toc_first_level.children %}
                                          <ul class="usa-sidenav__sublist">
                                              {% for toc_second_level in toc_first_level.children %}
                                                  <li class="usa-sidenav__item">
                                                      <a href="#{{ toc_second_level.id }}"
                                                      >{{ toc_second_level.name }}</a
                                                      >
                                                  </li>
                                              {% endfor %}
                                          </ul>
                                      {% endif %}
                                  </li>
                              {% endfor %}
                              </ul>
                          {% endif %}
                      {% endwith %}
                  {% endif %}
              </li>
          {% endfor%}
          </ul> 
        </nav>
      </div>
    </div>
  </div>
{% endblock %}